//! This file is auto-generated. Disable this by adding an `@manual` tag.
//!
//! @manual @generated by {COMMIT_HASH}

use alloc::string::{String, ToString};
use core::net::SocketAddr;

#[cfg(feature = "facet")]
use facet_minecraft as mc;
use froglight_common::version::Version;

use crate::core::intent::ConnectionIntent;

#[derive(Debug, Clone, PartialEq, Eq, Hash)]
#[cfg_attr(feature = "bevy", derive(bevy_reflect::Reflect))]
#[cfg_attr(feature = "bevy", reflect(Debug, Clone, PartialEq, Hash))]
#[cfg_attr(feature = "facet", derive(facet::Facet))]
pub struct HandshakeC2SPacket {
    #[cfg_attr(feature = "facet", facet(mc::variable))]
    pub protocol: u32,
    pub address: String,
    pub port: u16,
    pub intent: ConnectionIntent,
}

impl HandshakeC2SPacket {
    /// Create a new [`HandshakeC2SPacket`] with the given
    /// address, port, and [`ConnectionIntent`].
    #[must_use]
    pub fn new<V: Version>(address: impl ToString, port: u16, intent: ConnectionIntent) -> Self {
        Self::new_raw(V::PROTOCOL_ID, address.to_string(), port, intent)
    }

    /// Create a new [`HandshakeC2SPacket`] with the given
    /// [`SocketAddr`] and [`ConnectionIntent`].
    #[inline]
    #[must_use]
    pub fn new_socket<V: Version>(socket: SocketAddr, intent: ConnectionIntent) -> Self {
        Self::new::<V>(socket.ip(), socket.port(), intent)
    }

    /// Create a new [`HandshakeC2SPacket`] with the given values.
    #[must_use]
    pub const fn new_raw(
        protocol: u32,
        address: String,
        port: u16,
        intent: ConnectionIntent,
    ) -> Self {
        Self { protocol, address, port, intent }
    }
}
